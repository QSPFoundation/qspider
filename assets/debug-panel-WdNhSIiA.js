import{j as o,R as Ue,T as He,P as Ge,C as We,A as Xe,r as c,u as Ke,a as Qe,c as Ye,b as Je,d as Z,e as Ne,f as Ze,I as et,g as ie,h as tt,i as ee,k as A,l as Y,m as nt,n as F,o as N,p as rt,q as ot,s as D,t as qe,v as st,w as it,V as at,x as ct,y as me,z as lt,B as ut,S as dt,D as gt,E as pt,F as ft,G as mt,H as bt,J as ht,K as vt,L as xt,M as jt,N as wt,O as yt,Q as Nt,U as qt}from"./index-3gqyGD0x.js";const Et={defaultToken:"",ignoreCase:!0,keywords:["set","let","local","act","end","if","else","elseif","loop","while","step","and","or","mod","no","obj","loc","exit","jump","gosub","gs","goto","gt","xgoto","xgt","pl","p","nl","clear","clr","*pl","*p","*nl","*clear","*clr","msg","wait","addobj","delobj","modobj","resetobj","killobj","unselect","unsel","killall","cla","delact","cls","cmdclear","cmdclr","menu","settimer","dynamic","setvar","killvar","copyarr","sortarr","scanstr","unpackarr","opengame","savegame","openqst","inclib","freelib","refint","showacts","showinput","showobjs","showstat","play","close","view","desc","mod","max","min","rand","rnd","val","iif","dyneval","func","input","usrtxt","user_text","maintxt","stattxt","getobj","countobj","selobj","curloc","curobjs","selact","curacts","arrsize","arrtype","arritem","arrpack","arrpos","arrcomp","instr","isnum","trim","ucase","lcase","len","mid","replace","str","strcomp","strfind","strpos","isplay","rgb","msecscount","qspver"],operators:["=","<>","<=",">=","<",">","+","-","*","/","&"],symbols:/[=><!~?:&|+\-*/%^]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/@@[a-zA-Z_]\w*/i,"function.call"],[/@[a-zA-Z_]\w*/i,"function.call"],[/[$#%][a-zA-Z_]\w*/,"variable"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"keyword","@default":"identifier"}}],[/!.*$/,"comment"],{include:"@whitespace"},[/[{}()[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/\d*\.\d+([eE][-+]?\d+)?/,"number.float"],[/\d+/,"number"],[/<</,{token:"string.interpolation",next:"@interpolation"}],[/'/,{token:"string.quote",bracket:"@open",next:"@string"}],[/"/,{token:"string.quote",bracket:"@open",next:"@dblstring"}]],interpolation:[[/>>/,{token:"string.interpolation",next:"@pop"}],[/[^>]+/,"string.interpolation.content"]],string:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,{token:"string.quote",bracket:"@close",next:"@pop"}]],dblstring:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]],comment:[[/[^/*]+/,"comment"],[/\/\*/,"comment","@push"],[/\*\//,"comment","@pop"],[/[/*]/,"comment"]]}},kt={comments:{lineComment:"!",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"',notIn:["string"]},{open:"'",close:"'",notIn:["string","comment"]}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],folding:{markers:{start:new RegExp("^\\s*#region\\b"),end:new RegExp("^\\s*#endregion\\b")}}};function Ct(e){e.languages.register({id:"qsp",extensions:[".qsp",".qsps"],aliases:["QSP","qsp"],mimetypes:["text/qsp"]}),e.languages.setLanguageConfiguration("qsp",kt),e.languages.setMonarchTokensProvider("qsp",Et)}const I=({onClick:e,tooltip:t,children:n,className:r="",disabled:s=!1})=>o.jsxs(Ue,{children:[o.jsx(He,{asChild:!0,children:o.jsx("button",{type:"button",onClick:e,className:r,disabled:s,children:n})}),o.jsx(Ge,{children:o.jsxs(We,{className:"q-tooltip",sideOffset:5,children:[t,o.jsx(Xe,{className:"q-tooltip-arrow"})]})})]});var te="Tabs",[St]=Ye(te,[Ne]),Ee=Ne(),[Mt,ge]=St(te),ke=c.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:l,activationMode:u="automatic",...f}=e,h=Ke(l),[b,E]=Qe({prop:r,onChange:s,defaultProp:i??"",caller:te});return o.jsx(Mt,{scope:n,baseId:Je(),value:b,onValueChange:E,orientation:a,dir:h,activationMode:u,children:o.jsx(Z.div,{dir:h,"data-orientation":a,...f,ref:t})})});ke.displayName=te;var Ce="TabsList",Se=c.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=ge(Ce,n),a=Ee(n);return o.jsx(Ze,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:o.jsx(Z.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});Se.displayName=Ce;var Me="TabsTrigger",Oe=c.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=ge(Me,n),l=Ee(n),u=Pe(a.baseId,r),f=Ie(a.baseId,r),h=r===a.value;return o.jsx(et,{asChild:!0,...l,focusable:!s,active:h,children:o.jsx(Z.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":f,"data-state":h?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:u,...i,ref:t,onMouseDown:ie(e.onMouseDown,b=>{!s&&b.button===0&&b.ctrlKey===!1?a.onValueChange(r):b.preventDefault()}),onKeyDown:ie(e.onKeyDown,b=>{[" ","Enter"].includes(b.key)&&a.onValueChange(r)}),onFocus:ie(e.onFocus,()=>{const b=a.activationMode!=="manual";!h&&!s&&b&&a.onValueChange(r)})})})});Oe.displayName=Me;var Le="TabsContent",Re=c.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,l=ge(Le,n),u=Pe(l.baseId,r),f=Ie(l.baseId,r),h=r===l.value,b=c.useRef(h);return c.useEffect(()=>{const E=requestAnimationFrame(()=>b.current=!1);return()=>cancelAnimationFrame(E)},[]),o.jsx(tt,{present:s||h,children:({present:E})=>o.jsx(Z.div,{"data-state":h?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":u,hidden:!E,id:f,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:b.current?"0s":void 0},children:E&&i})})});Re.displayName=Le;function Pe(e,t){return`${e}-trigger-${t}`}function Ie(e,t){return`${e}-content-${t}`}var Ot=ke,Lt=Se,ae=Oe,ce=Re;const Rt={main_changed:["text","isNewDesc"],stats_changed:["text"],actions_changed:["actions"],objects_changed:["objects"],panel_visibility:["type","isShown"],user_input:["text"],error:["errorData"],menu:["items"],msg:["text"],input:["text"],version:["type"],wait:["ms"],timer:["ms"],view:["path"],open_game:["path","isNewGame"],save_game:["path"],load_save:["path"],is_play:["file"],play_file:["path","volume"],close_file:["path"],system_cmd:["cmd"],debug:["record"]},Pt={1:"MAIN",2:"VARS",4:"ACTS",8:"OBJS",16:"INPUT",32:"VIEW"};function It(e){const t=[];for(const[n,r]of Object.entries(Pt)){const s=parseInt(n,10);e&s&&t.push(r)}return t.length>0?t.join(" | "):`Unknown(${e})`}function be(e){return!Array.isArray(e)||e.length===0?"[]":`[
${e.map((n,r)=>{if(n&&typeof n=="object"&&"name"in n){const s=n;let i=`"${s.name}"`;return"title"in s&&s.title&&s.title!==s.name&&(i+=` (${s.title})`),s.image&&(i+=` [img: ${s.image}]`),`  ${r}: ${i}`}return`  ${r}: ${JSON.stringify(n)}`}).join(`,
`)}
]`}function At(e,t){const n=Rt[e]||[];return t.map((r,s)=>{const i=n[s]||`arg${s}`;let a;if(e==="panel_visibility"&&i==="type"&&typeof r=="number")a=It(r);else if(e==="actions_changed"&&i==="actions"||e==="objects_changed"&&i==="objects")a=Array.isArray(r)?be(r):String(r);else if(e==="menu"&&i==="items")a=Array.isArray(r)?be(r):String(r);else if(typeof r=="function")a="[Function]";else if(typeof r=="string")a=`"${r}"`;else if(typeof r=="boolean")a=String(r);else if(typeof r=="number")a=String(r);else if(r===null)a="null";else if(r===void 0)a="undefined";else if(Array.isArray(r))a=`[${r.length} items]`;else if(r&&typeof r=="object")try{a=JSON.stringify(r)}catch{a="[Complex Object]"}else a=String(r);return{name:i,value:a}})}const Tt=()=>{const{t:e}=ee(),t=A.useAtom(Y),n=A.useAtom(nt),r=()=>{t.isEnabled?rt():ot()};return o.jsxs(Ot,{defaultValue:"execution",className:"qsp-debugger-right-panel",children:[o.jsxs(Lt,{className:"qsp-debugger-right-panel-tabs",children:[o.jsx(ae,{value:"execution",className:"qsp-debugger-right-panel-tab",children:e("Execution")}),o.jsx(ae,{value:"breakpoints",className:"qsp-debugger-right-panel-tab",children:e("Breakpoints")}),o.jsx(ae,{value:"events",className:"qsp-debugger-right-panel-tab",children:e("Events")})]}),o.jsx(ce,{value:"execution",className:"qsp-debugger-right-panel-content",children:o.jsxs("div",{children:[o.jsxs("div",{className:"qsp-debugger-execution-info",children:[o.jsx("div",{className:"qsp-debugger-execution-label",children:e("Debug Mode")}),o.jsxs("div",{className:"qsp-debugger-debug-toggle-section",children:[o.jsx("div",{className:`qsp-debugger-status ${t.isEnabled?"enabled":"disabled"}`,children:t.isEnabled?t.isPaused?o.jsxs("span",{className:"status-paused",children:["‚è∏ ",e("Paused")]}):o.jsxs("span",{className:"status-running",children:["‚ñ∂ ",e("Running")]}):o.jsxs("span",{className:"status-disabled",children:["‚èπ ",e("Disabled")]})}),o.jsx(F,{children:o.jsx(I,{onClick:r,tooltip:t.isEnabled?e("Stop debugging session"):e("Start debugging session"),className:`q-button qsp-debugger-toggle-button ${t.isEnabled?"enabled":"disabled"}`,children:t.isEnabled?e("Disable"):e("Enable")})})]})]}),t.isEnabled&&o.jsx(F,{children:o.jsxs("div",{className:"qsp-debugger-controls",children:[t.isPaused?o.jsxs(o.Fragment,{children:[o.jsxs(I,{onClick:N.resumeExecution,tooltip:e("Resume execution (F5)"),className:"q-button qsp-debugger-control-button resume",children:["‚ñ∂ ",e("Resume")]}),o.jsxs(I,{disabled:!n,onClick:N.stepExecution,tooltip:e("Step to next line (F10)"),className:"q-button qsp-debugger-control-button step",children:["‚è≠ ",e("Step")]})]}):o.jsxs(I,{onClick:N.pauseExecution,tooltip:e("Pause execution (F5 or F9)"),className:"q-button qsp-debugger-control-button pause",children:["‚è∏ ",e("Pause")]}),o.jsxs(I,{onClick:N.clearExecutionHistory,tooltip:e("Clear execution history"),className:"q-button qsp-debugger-control-button clear",children:["üóë ",e("Clear")]})]})}),t.isEnabled&&o.jsxs("div",{className:"qsp-debugger-execution-info",children:[o.jsx("div",{className:"qsp-debugger-execution-label",children:e("Pause on Links")}),o.jsxs("div",{className:"qsp-debugger-debug-toggle-section",children:[o.jsx("div",{className:`qsp-debugger-status ${t.autoPauseOnLinks?"enabled":"disabled"}`,children:t.autoPauseOnLinks?o.jsxs("span",{className:"status-running",children:["‚úì ",e("Enabled")]}):o.jsxs("span",{className:"status-disabled",children:["‚úó ",e("Disabled")]})}),o.jsx(F,{children:o.jsx(I,{onClick:N.toggleAutoPauseOnLinks,tooltip:t.autoPauseOnLinks?e("Disable pausing on link execution"):e("Enable pausing on link execution"),className:`q-button qsp-debugger-toggle-button ${t.autoPauseOnLinks?"enabled":"disabled"}`,children:t.autoPauseOnLinks?e("Disable"):e("Enable")})})]})]}),o.jsxs("div",{className:"qsp-debugger-execution-info",children:[o.jsx("div",{className:"qsp-debugger-execution-label",children:e("Current Execution")}),t.currentRecord?o.jsxs("div",{className:"qsp-debugger-current-execution",children:[o.jsxs("div",{children:[e("Location"),": ",t.currentRecord.loc]}),o.jsxs("div",{children:[e("Line"),": ",t.currentRecord.line]}),o.jsxs("div",{children:[e("Action"),": ",t.currentRecord.actIndex]})]}):o.jsx("div",{className:"qsp-debugger-no-data",children:e("No execution data")})]}),o.jsxs("div",{className:"qsp-debugger-execution-info",children:[o.jsx("div",{className:"qsp-debugger-execution-label",children:e("Execution History")}),o.jsx("div",{className:"qsp-debugger-execution-history",children:t.executionHistory.slice(-10).map((s,i)=>o.jsx("div",{className:"qsp-debugger-history-item",children:o.jsxs("div",{children:[s.loc,":",s.line]})},i))})]})]})}),o.jsxs(ce,{value:"breakpoints",className:"qsp-debugger-right-panel-content",children:[t.breakpoints.map(s=>o.jsx("div",{className:"qsp-debugger-breakpoint-item",children:o.jsxs("div",{className:"qsp-debugger-breakpoint-header",children:[o.jsxs("span",{className:`qsp-debugger-breakpoint-location ${s.enabled?"":"disabled"}`,style:{cursor:"pointer"},onClick:()=>N.selectLocationWithLine(s.location,s.line??null),children:[s.location,s.line&&`:${s.line}`]}),o.jsxs("div",{className:"qsp-debugger-breakpoint-controls",children:[o.jsx("button",{onClick:i=>{i.stopPropagation(),N.toggleBreakpoint(s.id)},className:`qsp-debugger-breakpoint-control ${s.enabled?"enabled":""}`,children:s.enabled?e("Enabled"):e("Disabled")}),o.jsx("button",{onClick:i=>{i.stopPropagation(),N.removeBreakpoint(s.id)},className:"qsp-debugger-breakpoint-control remove",children:e("Remove")})]})]})},s.id)),t.breakpoints.length===0&&o.jsx("div",{className:"qsp-debugger-no-data",children:e("No breakpoints set")})]}),o.jsxs(ce,{value:"events",className:"qsp-debugger-right-panel-content",children:[o.jsxs("div",{className:"qsp-debugger-events-header",children:[o.jsx(F,{children:o.jsx("div",{className:"qsp-debugger-events-controls",children:o.jsxs(I,{onClick:N.clearEventLog,tooltip:e("Clear all logged events"),className:"q-button qsp-debugger-control-button clear",children:["üóë ",e("Clear Events")]})})}),o.jsxs("div",{className:"qsp-debugger-events-count",children:[e("Events"),": ",t.eventLog.length]})]}),o.jsx("div",{className:"qsp-debugger-events-list",children:t.eventLog.slice().reverse().map(s=>o.jsxs("div",{className:"qsp-debugger-event-item",children:[o.jsxs("div",{className:"qsp-debugger-event-header",children:[o.jsx("span",{className:"qsp-debugger-event-name",children:s.event}),o.jsx("span",{className:"qsp-debugger-event-timestamp",children:new Date(s.timestamp).toLocaleTimeString()})]}),s.args.length>0&&o.jsx("div",{className:"qsp-debugger-event-args",children:At(s.event,s.args).map((i,a)=>o.jsxs("div",{className:"qsp-debugger-event-arg",children:[o.jsxs("span",{className:"qsp-debugger-event-arg-name",children:[i.name,":"]}),o.jsx("span",{className:"qsp-debugger-event-arg-value",children:i.value})]},a))})]},s.id))}),t.eventLog.length===0&&o.jsx("div",{className:"qsp-debugger-no-data",children:e("No events logged yet")})]})]})};function $t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?he(Object(n),!0).forEach(function(r){$t(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Dt(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function _t(e,t){if(e==null)return{};var n=Dt(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ft(e,t){return Vt(e)||Bt(e,t)||zt(e,t)||Ut()}function Vt(e){if(Array.isArray(e))return e}function Bt(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,s=!1,i=void 0;try{for(var a=e[Symbol.iterator](),l;!(r=(l=a.next()).done)&&(n.push(l.value),!(t&&n.length===t));r=!0);}catch(u){s=!0,i=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(s)throw i}}return n}}function zt(e,t){if(e){if(typeof e=="string")return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xe(e,t)}}function xe(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?je(Object(n),!0).forEach(function(r){Ht(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Gt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduceRight(function(s,i){return i(s)},r)}}function z(e){return function t(){for(var n=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return s.length>=e.length?e.apply(this,s):function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return t.apply(n,[].concat(s,l))}}}function J(e){return{}.toString.call(e).includes("Object")}function Wt(e){return!Object.keys(e).length}function H(e){return typeof e=="function"}function Xt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Kt(e,t){return J(t)||$("changeType"),Object.keys(t).some(function(n){return!Xt(e,n)})&&$("changeField"),t}function Qt(e){H(e)||$("selectorType")}function Yt(e){H(e)||J(e)||$("handlerType"),J(e)&&Object.values(e).some(function(t){return!H(t)})&&$("handlersType")}function Jt(e){e||$("initialIsRequired"),J(e)||$("initialType"),Wt(e)&&$("initialContent")}function Zt(e,t){throw new Error(e[t]||e.default)}var en={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},$=z(Zt)(en),K={changes:Kt,selector:Qt,handler:Yt,initial:Jt};function tn(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};K.initial(e),K.handler(t);var n={current:e},r=z(on)(n,t),s=z(rn)(n),i=z(K.changes)(e),a=z(nn)(n);function l(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(h){return h};return K.selector(f),f(n.current)}function u(f){Gt(r,s,i,a)(f)}return[l,u]}function nn(e,t){return H(t)?t(e.current):t}function rn(e,t){return e.current=we(we({},e.current),t),t}function on(e,t,n){return H(t)?t(e.current):Object.keys(n).forEach(function(r){var s;return(s=t[r])===null||s===void 0?void 0:s.call(t,e.current[r])}),n}var sn={create:tn},an={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function cn(e){return function t(){for(var n=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return s.length>=e.length?e.apply(this,s):function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return t.apply(n,[].concat(s,l))}}}function ln(e){return{}.toString.call(e).includes("Object")}function un(e){return e||ye("configIsRequired"),ln(e)||ye("configType"),e.urls?(dn(),{paths:{vs:e.urls.monacoBase}}):e}function dn(){console.warn(Ae.deprecation)}function gn(e,t){throw new Error(e[t]||e.default)}var Ae={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},ye=cn(gn)(Ae),pn={config:un},fn=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(s){return n.reduceRight(function(i,a){return a(i)},s)}};function Te(e,t){return Object.keys(t).forEach(function(n){t[n]instanceof Object&&e[n]&&Object.assign(t[n],Te(e[n],t[n]))}),ve(ve({},e),t)}var mn={type:"cancelation",msg:"operation is manually canceled"};function le(e){var t=!1,n=new Promise(function(r,s){e.then(function(i){return t?s(mn):r(i)}),e.catch(s)});return n.cancel=function(){return t=!0},n}var bn=sn.create({config:an,isInitialized:!1,resolve:null,reject:null,monaco:null}),$e=Ft(bn,2),G=$e[0],ne=$e[1];function hn(e){var t=pn.config(e),n=t.monaco,r=_t(t,["monaco"]);ne(function(s){return{config:Te(s.config,r),monaco:n}})}function vn(){var e=G(function(t){var n=t.monaco,r=t.isInitialized,s=t.resolve;return{monaco:n,isInitialized:r,resolve:s}});if(!e.isInitialized){if(ne({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),le(ue);if(window.monaco&&window.monaco.editor)return De(window.monaco),e.resolve(window.monaco),le(ue);fn(xn,wn)(yn)}return le(ue)}function xn(e){return document.body.appendChild(e)}function jn(e){var t=document.createElement("script");return e&&(t.src=e),t}function wn(e){var t=G(function(r){var s=r.config,i=r.reject;return{config:s,reject:i}}),n=jn("".concat(t.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=t.reject,n}function yn(){var e=G(function(n){var r=n.config,s=n.resolve,i=n.reject;return{config:r,resolve:s,reject:i}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(n){De(n),e.resolve(n)},function(n){e.reject(n)})}function De(e){G().monaco||ne({monaco:e})}function Nn(){return G(function(e){var t=e.monaco;return t})}var ue=new Promise(function(e,t){return ne({resolve:e,reject:t})}),_e={config:hn,init:vn,__getMonacoInstance:Nn},qn={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},de=qn,En={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},kn=En;function Cn({children:e}){return D.createElement("div",{style:kn.container},e)}var Sn=Cn,Mn=Sn;function On({width:e,height:t,isEditorReady:n,loading:r,_ref:s,className:i,wrapperProps:a}){return D.createElement("section",{style:{...de.wrapper,width:e,height:t},...a},!n&&D.createElement(Mn,null,r),D.createElement("div",{ref:s,style:{...de.fullWidth,...!n&&de.hide},className:i}))}var Ln=On,Fe=c.memo(Ln);function Rn(e){c.useEffect(e,[])}var Ve=Rn;function Pn(e,t,n=!0){let r=c.useRef(!0);c.useEffect(r.current||!n?()=>{r.current=!1}:e,t)}var P=Pn;function U(){}function V(e,t,n,r){return In(e,r)||An(e,t,n,r)}function In(e,t){return e.editor.getModel(Be(e,t))}function An(e,t,n,r){return e.editor.createModel(t,n,r?Be(e,r):void 0)}function Be(e,t){return e.Uri.parse(t)}function Tn({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:s,originalModelPath:i,modifiedModelPath:a,keepCurrentOriginalModel:l=!1,keepCurrentModifiedModel:u=!1,theme:f="light",loading:h="Loading...",options:b={},height:E="100%",width:M="100%",className:R,wrapperProps:g={},beforeMount:q=U,onMount:k=U}){let[w,m]=c.useState(!1),[C,d]=c.useState(!0),v=c.useRef(null),p=c.useRef(null),O=c.useRef(null),x=c.useRef(k),j=c.useRef(q),_=c.useRef(!1);Ve(()=>{let y=_e.init();return y.then(S=>(p.current=S)&&d(!1)).catch(S=>S?.type!=="cancelation"&&console.error("Monaco initialization: error:",S)),()=>v.current?B():y.cancel()}),P(()=>{if(v.current&&p.current){let y=v.current.getOriginalEditor(),S=V(p.current,e||"",r||n||"text",i||"");S!==y.getModel()&&y.setModel(S)}},[i],w),P(()=>{if(v.current&&p.current){let y=v.current.getModifiedEditor(),S=V(p.current,t||"",s||n||"text",a||"");S!==y.getModel()&&y.setModel(S)}},[a],w),P(()=>{let y=v.current.getModifiedEditor();y.getOption(p.current.editor.EditorOption.readOnly)?y.setValue(t||""):t!==y.getValue()&&(y.executeEdits("",[{range:y.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),y.pushUndoStop())},[t],w),P(()=>{v.current?.getModel()?.original.setValue(e||"")},[e],w),P(()=>{let{original:y,modified:S}=v.current.getModel();p.current.editor.setModelLanguage(y,r||n||"text"),p.current.editor.setModelLanguage(S,s||n||"text")},[n,r,s],w),P(()=>{p.current?.editor.setTheme(f)},[f],w),P(()=>{v.current?.updateOptions(b)},[b],w);let W=c.useCallback(()=>{if(!p.current)return;j.current(p.current);let y=V(p.current,e||"",r||n||"text",i||""),S=V(p.current,t||"",s||n||"text",a||"");v.current?.setModel({original:y,modified:S})},[n,t,s,e,r,i,a]),X=c.useCallback(()=>{!_.current&&O.current&&(v.current=p.current.editor.createDiffEditor(O.current,{automaticLayout:!0,...b}),W(),p.current?.editor.setTheme(f),m(!0),_.current=!0)},[b,f,W]);c.useEffect(()=>{w&&x.current(v.current,p.current)},[w]),c.useEffect(()=>{!C&&!w&&X()},[C,w,X]);function B(){let y=v.current?.getModel();l||y?.original?.dispose(),u||y?.modified?.dispose(),v.current?.dispose()}return D.createElement(Fe,{width:M,height:E,isEditorReady:w,loading:h,_ref:O,className:R,wrapperProps:g})}var $n=Tn;c.memo($n);function Dn(e){let t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}var _n=Dn,Q=new Map;function Fn({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:s,path:i,theme:a="light",line:l,loading:u="Loading...",options:f={},overrideServices:h={},saveViewState:b=!0,keepCurrentModel:E=!1,width:M="100%",height:R="100%",className:g,wrapperProps:q={},beforeMount:k=U,onMount:w=U,onChange:m,onValidate:C=U}){let[d,v]=c.useState(!1),[p,O]=c.useState(!0),x=c.useRef(null),j=c.useRef(null),_=c.useRef(null),W=c.useRef(w),X=c.useRef(k),B=c.useRef(),y=c.useRef(r),S=_n(i),pe=c.useRef(!1),re=c.useRef(!1);Ve(()=>{let L=_e.init();return L.then(T=>(x.current=T)&&O(!1)).catch(T=>T?.type!=="cancelation"&&console.error("Monaco initialization: error:",T)),()=>j.current?ze():L.cancel()}),P(()=>{let L=V(x.current,e||r||"",t||s||"",i||n||"");L!==j.current?.getModel()&&(b&&Q.set(S,j.current?.saveViewState()),j.current?.setModel(L),b&&j.current?.restoreViewState(Q.get(i)))},[i],d),P(()=>{j.current?.updateOptions(f)},[f],d),P(()=>{!j.current||r===void 0||(j.current.getOption(x.current.editor.EditorOption.readOnly)?j.current.setValue(r):r!==j.current.getValue()&&(re.current=!0,j.current.executeEdits("",[{range:j.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),j.current.pushUndoStop(),re.current=!1))},[r],d),P(()=>{let L=j.current?.getModel();L&&s&&x.current?.editor.setModelLanguage(L,s)},[s],d),P(()=>{l!==void 0&&j.current?.revealLine(l)},[l],d),P(()=>{x.current?.editor.setTheme(a)},[a],d);let fe=c.useCallback(()=>{if(!(!_.current||!x.current)&&!pe.current){X.current(x.current);let L=i||n,T=V(x.current,r||e||"",t||s||"",L||"");j.current=x.current?.editor.create(_.current,{model:T,automaticLayout:!0,...f},h),b&&j.current.restoreViewState(Q.get(L)),x.current.editor.setTheme(a),l!==void 0&&j.current.revealLine(l),v(!0),pe.current=!0}},[e,t,n,r,s,i,f,h,b,a,l]);c.useEffect(()=>{d&&W.current(j.current,x.current)},[d]),c.useEffect(()=>{!p&&!d&&fe()},[p,d,fe]),y.current=r,c.useEffect(()=>{d&&m&&(B.current?.dispose(),B.current=j.current?.onDidChangeModelContent(L=>{re.current||m(j.current.getValue(),L)}))},[d,m]),c.useEffect(()=>{if(d){let L=x.current.editor.onDidChangeMarkers(T=>{let oe=j.current.getModel()?.uri;if(oe&&T.find(se=>se.path===oe.path)){let se=x.current.editor.getModelMarkers({resource:oe});C?.(se)}});return()=>{L?.dispose()}}return()=>{}},[d,C]);function ze(){B.current?.dispose(),E?b&&Q.set(i,j.current.saveViewState()):j.current.getModel()?.dispose(),j.current.dispose()}return D.createElement(Fe,{width:M,height:R,isEditorReady:d,loading:u,_ref:_,className:g,wrapperProps:q})}var Vn=Fn,Bn=c.memo(Vn);const zn=({code:e,language:t="qsp",theme:n="vs",height:r="300px",currentLine:s,targetLine:i,title:a,locationName:l,actionIndex:u,breakpoints:f=[],onBreakpointToggle:h,forceUpdate:b})=>{const{t:E}=ee(),M=c.useRef(null),R=c.useRef(null),[g,q]=c.useState(!1),k=c.useRef(),w=D.useCallback(d=>{h&&h(d,l||"",u)},[h,l,u]);k.current=w;const m=d=>{M.current=d,window.monaco&&Ct(window.monaco),d.updateOptions({readOnly:!0,minimap:{enabled:!0},scrollBeyondLastLine:!1,wordWrap:"on",lineNumbers:"on",folding:!0,selectOnLineNumbers:!0,automaticLayout:!0,fontSize:13,fontFamily:'Consolas, "Courier New", monospace',glyphMargin:!0}),h&&l&&d.onMouseDown(v=>{if(v.target.type===window.monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN){const p=v.target.position?.lineNumber;p&&k.current?.(p)}}),q(!0)};c.useEffect(()=>{if(M.current&&s&&s>0&&window.monaco){const d=M.current,v=d.createDecorationsCollection([{range:new window.monaco.Range(s,1,s,1),options:{isWholeLine:!0,className:"qsp-current-line-decoration",marginClassName:"qsp-current-line-margin"}}]);return d.revealLineInCenter(s),()=>{v.clear()}}},[g,s]),c.useEffect(()=>{M.current&&i&&i>0&&window.monaco&&M.current.revealLineInCenter(i)},[g,i]),c.useEffect(()=>{if(M.current&&l&&g){const d=M.current,p=f.filter(x=>x.location===l&&x.line!==void 0&&(u!==void 0?x.actionIndex===u:x.actionIndex===void 0)).map(x=>({range:new window.monaco.Range(x.line,1,x.line,1),options:{isWholeLine:!1,glyphMarginClassName:x.enabled?"qsp-breakpoint-enabled":"qsp-breakpoint-disabled",glyphMarginHoverMessage:{value:x.enabled?E("Breakpoint (enabled) - Click to disable"):E("Breakpoint (disabled) - Click to enable")},className:x.enabled?"qsp-breakpoint-line-enabled":"qsp-breakpoint-line-disabled",marginClassName:x.enabled?"qsp-breakpoint-margin-enabled":"qsp-breakpoint-margin-disabled"}}));R.current&&R.current.clear();const O=setTimeout(()=>{R.current=d.createDecorationsCollection(p),d.layout()},100);return()=>{clearTimeout(O),R.current&&R.current.clear()}}},[g,f,l,u]);const C={readOnly:!0,minimap:{enabled:!0},scrollBeyondLastLine:!1,wordWrap:"on",lineNumbers:"on",folding:!0,selectOnLineNumbers:!0,automaticLayout:!0,fontSize:13,fontFamily:'Consolas, "Courier New", monospace',padding:{top:8,bottom:8},renderLineHighlight:"line",cursorStyle:"line",hideCursorInOverviewRuler:!0,glyphMargin:!0};return o.jsxs("div",{className:"qsp-monaco-code-viewer",children:[a&&o.jsx("div",{className:"qsp-monaco-code-title",children:a}),o.jsx("div",{className:"qsp-monaco-editor-container",children:o.jsx(Bn,{height:r,language:t,theme:n,value:e,options:C,onMount:m,loading:o.jsx("div",{className:"qsp-monaco-loading",children:"Loading editor..."})})})]})},Un=()=>{const{t:e}=ee(),t=A.useAtom(Y),[n,r]=c.useState(null),[s,i]=c.useState(!1),[a,l]=c.useState("location"),[u,f]=c.useState(0),[h,b]=c.useState(0),[E,M]=c.useState(null);if(c.useEffect(()=>{b(m=>m+1)},[t.breakpoints]),c.useEffect(()=>{t.isEnabled&&t.currentRecord&&(E?.loc!==t.currentRecord.loc||E?.line!==t.currentRecord.line||E?.actIndex!==t.currentRecord.actIndex)&&(M(t.currentRecord),N.selectLocation(t.currentRecord.loc),t.currentRecord.actIndex>=0?(l("action"),f(t.currentRecord.actIndex)):l("location"))},[t.currentRecord,t.isEnabled,E]),c.useEffect(()=>{if(t.selectedLocation){if(t.selectedLocation==="[EXEC Link]"){r({name:"[EXEC Link]",code:t.currentRecord?.code?[t.currentRecord.code]:[],actions:[],description:""}),i(!1),l("location");return}i(!0),qe.getLocationInfo(t.selectedLocation).then(m=>{r(m),i(!1),f(0)})}else r(null)},[t.selectedLocation,t.currentRecord]),!t.selectedLocation)return o.jsx("div",{className:"qsp-debugger-empty-state",children:e("Select a location to view its code")});if(s)return o.jsx("div",{className:"qsp-debugger-loading",children:e("Loading code...")});if(!n)return o.jsx("div",{className:"qsp-debugger-error",children:e("Failed to load location code")});const R=()=>{if(!(!t.currentRecord||t.currentRecord.loc!==t.selectedLocation)){if(t.selectedLocation==="[EXEC Link]")return 1;if(a==="location")return t.currentRecord.line;if(a==="action"&&t.currentRecord.actIndex===u)return t.currentRecord.line}},g=()=>t.targetLine??void 0,q=()=>{if(a==="location")return n.code.join(`
`)||e("// No location code");if(a==="description")return n.description||e("// No location description");{const m=n.actions[u];return m?m.join(`
`):e("// Empty action")}},k=()=>a==="location"?e("Location: {{name}}",{name:n.name}):a==="description"?e("Description: {{name}}",{name:n.name}):e("Action {{index}} in {{location}}",{index:u+1,location:n.name}),w=(m,C,d)=>{const p=Y.value.breakpoints.find(O=>O.location===C&&O.line===m&&O.actionIndex===d);p?N.toggleBreakpoint(p.id):N.addBreakpoint({location:C,line:m,actionIndex:d,enabled:!0})};return o.jsxs("div",{className:"qsp-debugger-code-viewer",children:[o.jsxs("div",{className:"qsp-debugger-code-controls",children:[o.jsxs("div",{className:"qsp-debugger-code-type-selector",children:[o.jsx("button",{onClick:()=>l("location"),className:`qsp-debugger-code-type-button ${a==="location"?"active":""}`,children:e("Location Code")}),o.jsx("button",{onClick:()=>l("description"),className:`qsp-debugger-code-type-button ${a==="description"?"active":""}`,children:e("Description")}),n.actions.length>0&&o.jsx("button",{onClick:()=>l("action"),className:`qsp-debugger-code-type-button ${a==="action"?"active":""}`,children:e("Actions ({{count}})",{count:n.actions.length})})]}),a==="action"&&n.actions.length>0&&o.jsx("div",{className:"qsp-debugger-action-selector",children:o.jsxs(st,{value:u.toString(),onValueChange:m=>f(Number(m)),children:[o.jsxs(it,{className:"qsp-debugger-action-select",children:[o.jsx(at,{}),o.jsx(ct,{children:o.jsx(me,{})})]}),o.jsx(lt,{children:o.jsxs(ut,{className:"q-select-content",children:[o.jsx(dt,{className:"q-select-scroll-button",children:o.jsx(gt,{})}),o.jsx(pt,{children:n.actions.map((m,C)=>o.jsxs(ft,{value:C.toString(),className:"q-select-item",children:[o.jsx(mt,{children:e("Action {{number}}",{number:C+1})}),o.jsx(bt,{className:"q-select-item-indicator",children:o.jsx(ht,{})})]},C))}),o.jsx(vt,{className:"q-select-scroll-button",children:o.jsx(me,{})})]})})]})})]}),o.jsx("div",{className:"qsp-debugger-monaco-container",children:o.jsx(zn,{code:q(),language:a==="description"?"html":"qsp",theme:"vs",height:"100%",currentLine:R(),targetLine:g(),title:k(),locationName:t.selectedLocation,actionIndex:a==="action"?u:void 0,breakpoints:t.breakpoints,onBreakpointToggle:w,forceUpdate:h})})]})},Gn=()=>{const{t:e}=ee(),t=A.useAtom(xt),n=A.useAtom(Y),r=A.useAtom(jt),s=A.useAtom(wt),i=A.useAtom(yt),a=A.useAtom(Nt),l=A.useAtom(qt),[u,f]=c.useState(!1),h=c.useMemo(()=>`(v${t?.version()} - ${t?.getCompiledDateTime()})`,[t]);c.useEffect(()=>{i&&qe.refreshLocations()},[i]),c.useEffect(()=>{if(!i||!n.isEnabled)return;const g=q=>{if(!(q.target instanceof HTMLInputElement||q.target instanceof HTMLTextAreaElement))switch(q.key){case"F5":q.preventDefault(),n.isPaused?N.resumeExecution():N.pauseExecution();break;case"F10":q.preventDefault(),n.isPaused&&N.stepExecution();break;case"F9":q.preventDefault(),N.pauseExecution();break}};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[i,n.isEnabled,n.isPaused]);const b=g=>{g.preventDefault(),f(!0);const q=g.clientX,k=g.clientY,w=l.width,m=l.height,C=v=>{let p;if(a==="bottom"){const O=m-(v.clientY-k);p={...l,height:Math.max(200,Math.min(window.innerHeight*.8,O))}}else{const O=a==="right"?w-(v.clientX-q):w+(v.clientX-q);p={...l,width:Math.max(300,Math.min(window.innerWidth*.8,O))}}N.setPanelSize(p)},d=()=>{f(!1),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",d)},E={...a==="bottom"&&{height:l.height},...a!=="bottom"&&{width:l.width}},M=g=>{N.selectLocation(g)},R=g=>{const q=n.breakpoints.find(k=>k.location===g&&k.line===void 0&&k.actionIndex===void 0);q?N.removeBreakpoint(q.id):N.addBreakpoint({location:g,enabled:!0})};return o.jsxs("div",{className:`qsp-debugger-container ${a} ${i?"":"hidden"}`,style:E,children:[o.jsx("div",{className:`qsp-debugger-resizer ${u?"resizing":""}`,onMouseDown:b}),o.jsxs("div",{className:"qsp-debugger-header",children:[o.jsxs("div",{className:"qsp-debugger-title",children:[e("QSP Debugger")," ",h]}),o.jsx("div",{className:"qsp-debugger-header-controls",children:o.jsxs(F,{children:[o.jsxs("div",{className:"qsp-debugger-dock-controls",children:[o.jsx(I,{onClick:()=>N.setDockPosition("left"),tooltip:e("Dock to left"),className:`qsp-debugger-dock-button ${a==="left"?"active":""}`,children:"‚¨Ö"}),o.jsx(I,{onClick:()=>N.setDockPosition("bottom"),tooltip:e("Dock to bottom"),className:`qsp-debugger-dock-button ${a==="bottom"?"active":""}`,children:"‚¨á"}),o.jsx(I,{onClick:()=>N.setDockPosition("right"),tooltip:e("Dock to right"),className:`qsp-debugger-dock-button ${a==="right"?"active":""}`,children:"‚û°"})]}),o.jsx(I,{onClick:()=>N.closeDebugPanel(),tooltip:e("Close debugger panel"),className:"qsp-debugger-close-button",children:"‚úï"})]})})]}),o.jsxs("div",{className:"qsp-debugger-content",children:[o.jsx("div",{className:"qsp-debugger-sidebar",children:o.jsxs("div",{className:"qsp-debugger-locations-content",children:[r&&o.jsx("div",{className:"qsp-debugger-loading",children:e("Loading...")}),s&&o.jsx("div",{className:"qsp-debugger-error",children:s}),n.locations.map(g=>{const q=n.selectedLocation===g,k=n.currentRecord?.loc===g,w=n.breakpoints.some(m=>m.location===g&&m.line===void 0&&m.actionIndex===void 0);return o.jsxs("div",{className:`qsp-debugger-location-item ${q?"selected":""} ${k?"current-execution":""}`,onClick:()=>M(g),children:[o.jsxs("span",{className:"qsp-debugger-location-name",children:[k&&o.jsx("span",{className:"execution-indicator",children:"‚ñ∂ "}),g]}),o.jsx(F,{children:o.jsx(I,{onClick:m=>{m.stopPropagation(),R(g)},tooltip:w?e("Remove breakpoint from {{location}}",{location:g}):e("Add breakpoint to {{location}}",{location:g}),className:`qsp-debugger-breakpoint-button ${w?"has-breakpoint":""}`,children:"‚óè"})})]},g)})]})}),o.jsx("div",{className:"qsp-debugger-main",children:o.jsxs("div",{className:"qsp-debugger-main-with-panel",children:[o.jsx("div",{className:"qsp-debugger-code-section",children:o.jsx(Un,{})}),o.jsx("div",{className:"qsp-debugger-right-panel-main",children:o.jsx(Tt,{})})]})})]})]})};export{Gn as DebugPanel};
